# 筆記体風ジェネレータ

ASCII を入力すると、**多値 QAM コンステレーション**をなぞるような**筆記体っぽいうねうね**を描画します。

> ロシア語の筆記体の軌跡が QAM の点列をつないだ軌跡と似ていたので、
> 「文字列 → QAM シンボル列 → 曲線描画」で試してみました。

---

## 🧩 成果物

https://nyatla-ai.github.io/une2/



---

## 🚀 使い方

1. 上記 2 ファイルを同じフォルダに置く
2. `筆記体風ジェネレータ_v1.html` をブラウザで開く
3. 上部の **TEXT（ASCII）** に文字列を入力（初期例：`HELLOWORLD`）

   * 対応文字：**A–Z / 0–9**（空白は無視）
   * 未対応文字が含まれると**入力欄が赤字&赤枠**になり、再入力を促します（描画は停止）
4. 「画像生成パラメータ」で描画を調整

   * **PAD**：星座図の余白
   * **shift**：軌跡を横にずらす量（大きいほど“くずし字/カルテ”風に）
   * **lineWidth / lineColor**：線の太さ/色
5. **最終出力（QAM 16）** が自動で更新されます。**PNG 保存**で画像を書き出し可能
6. 画面下部に、入力した各文字の**4×4ドット画像**と**行ごとの 4bit 値**、
   最終 **シンボル列（1..16）** を表示

---

## 🧠 アルゴリズム

1. **文字列を大文字化＆バリデーション**
   `A–Z / 0–9`（空白はスキップ）のみ採用。未対応があればエラー表示。
2. **4×4 ビットマップフォントへマッピング**
   各文字を 16bit のビットマップ値 `fontData[ch]` に対応付け。
3. **4bit×4 行に分割（上→下）**
   行 `r = 0..3` に対し、次で 4bit を抽出：

   ```js
   const rowVal = (bitmap >> (12 - 4*r)) & 0xF; // 上→下、左MSB
   ```

   例：`A = 0x69f9` → `0110, 1001, 1111, 1001` → **\[6, 9, 15, 9]**
4. **Index 化（固定）**
   描画エンジンは **1..16** の整数列を受け取るため、**0..15 → +1** で変換。

   ```js
   const indices = nibbles.map(v => (v & 0xF) + 1); // 0..15 → 1..16
   ```
5. **QAM の点列をベジエで連結**
   コンステレーションの**オフセット**を横方向にずらしながら、点列を**ベジエ曲線**でスムーズに接続して描画。

---

## 🧪 開発の足跡（ログ）

* まず **QAM コンステレーション**を描画
* **オフセット**を動かしながら描く → それっぽい
* 文字列を **ASCII** にして **4bit** ずつ出力 → 面白いが**文字間距離が近い**
* **4×4 ビットマップ**に切り替え、**4bit×4** で距離を稼ぐ
* ※そろそろ飽きてきた
* とりあえず **FIX して完成**

---

## 💡 ポイント

* **読めない**（設計どおり）
* **shift** を大きくすると、より**カルテっぽい**崩し線に
* 数列（1..16）は読み取り専用。内部の Index 化は**0→1 固定**
* 非対応文字が入ると**赤い警告**で描画を止めるので、**A–Z / 0–9**で再入力

---

## 📦 実装メモ

* フォントは **4×4 = 16bit**（上位ビットほど上の行・左側）
* 行の抜き出しは `(bitmap >> (12 - 4*r)) & 0xF`
* 依存：`qam_image_generator.js`（同ディレクトリ必須）

---


